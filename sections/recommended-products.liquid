{% assign productitems='' %}{% if section.settings.show_related_products==true %}<div class="product-template__container page-width" itemscope itemtype="http://schema.org/Product" id="ProductSection-{{section.id}}" data-section-id="{{section.id}}" data-section-type="product" data-enable-history-state="true"> <section class="product_related product_home_carousel">{% assign number_of_related_products_per_row=section.settings.related_grid_num %}{% assign number_of_rows=section.settings.related_grid_row %}{% assign heading=section.settings.related_title %}{% if product.metafields.related_item.r_iems.value %}{% assign productitems=product.metafields.related_item.r_iems.value | split: "|" %}{% assign counter=0 %}{% assign break_at=number_of_rows | times: number_of_related_products_per_row %}{% case number_of_related_products_per_row %}{% when '1' %}{% assign grid_item_width='' %}{% when '2' %}{% assign grid_item_width='large--one-half medium--one-half' %}{% when '3' %}{% assign grid_item_width='large--one-third medium--one-half' %}{% when '4' %}{% assign grid_item_width='large--one-quarter medium--one-third small--one-half' %}{% when '5' %}{% assign grid_item_width='large--one-fifth medium--one-third small--one-half' %}{% when '6' %}{% assign grid_item_width='large--one-sixth medium--one-third small--one-half' %}{% else %}{% assign grid_item_width='large--one-quarter medium--one-third small--one-half' %}{% endcase %}{% capture related_items %}{% for productlist in productitems %}{% assign product=all_products[productlist] %}{% assign product1=all_products[productlist] %}{% unless product==blank %}{% include 'col-grid-item-recommended', product:product %}{% endunless %}{% assign counter=counter | plus: 1 %}{% if counter==break_at %}{% break %}{% endif %}{% endfor %}{% endcapture %}{% assign related_items=related_items | trim %}{% unless related_items==blank %}{% unless heading==blank %}<!--<header class="section-header "> <div class="routine-copy"> <h2>{{'shop_gallery.recommendation.title' | t: title}}</h2> </div></header>-->{% endunless %}<div class="home_product_carousel1">{{related_items}}</div>{% endunless %}{% endif %}</section></div>{% endif %}<script>dataLayer.push({ecommerce: null});dataLayer.push({'ecommerce':{'currencyCode': 'EUR', 'impressions': [{% for product in productitems.products %}{'name': '{{all_products[product].title}}', 'id': '{{all_products[product].id}}', 'price': '{{all_products[product].price | divided_by:100.00}}', 'brand': '{{all_products[product].vendor}}', 'category': '{{all_products[product].collections[1].title}}', 'variant': '{{all_products[product].selected_or_first_available_variant.title}}', 'list': '{{all_products[product].collections[1].title}}', 'position':{{forloop.index}}}{% unless forloop.last%},{% endunless %}{% endfor %}]}});</script>{% schema %}{"name": "Related products", "settings": [{"type": "checkbox", "id": "show_related_products", "label": "Show related products", "default": false},{"id": "related_title", "type": "text", "label": "Section title", "default": "Other fine products"},{"type": "select", "id": "related_grid_num", "label": "Products per row (Desktop)", "default": "4", "options": [{"value": "2", "label": "2"},{"value": "3", "label": "3"},{"value": "4", "label": "4"},{"value": "5", "label": "5"}]},{"type": "select", "id": "related_grid_row", "label": "Number of rows (Desktop)", "default": "1", "options": [{"value": "1", "label": "1"},{"value": "2", "label": "2"},{"value": "3", "label": "3"}]}]}{% endschema %}